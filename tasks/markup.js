'use strict';

const rootPath = process.cwd(),
        concat = require('gulp-concat-util'),
        gulp = require('gulp'),
        gulpfile = require(`${rootPath}/gulpfile.js`),
        markupConfig = gulpfile.config.markup,
        markupTasks = markupConfig.tasks;

function generateMacroConcatenateTask(c) {
    if (c.componentMacros) {
        gulp.task(`${markupConfig.concatMacrosTaskPrefix}${c.name}`, function(){
            return gulp.src(c.componentMacros)
                .pipe(concat(c.componentMacroFilename))
                .pipe(concat.header('{# DO NOT EDIT: This file is automatically generated by the project\'s build task #}\n'))
                .pipe(gulp.dest(c.componentMacroOutputPath));
        });
    }
}

markupTasks.forEach(function(c){
    // const buildLintTask = c.lintPaths;
    generateMacroConcatenateTask(c);
});
